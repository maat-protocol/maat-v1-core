
---
title: Testing generation of schemes
---
classDiagram

	class IntentionGenerator {
		âš™ï¸ uint nonce
		âš™ï¸ _generateIntentionId() intentionId 
	}

	class Ownable {
		ğŸ”’ address _owner
		â—ğŸ‘€ owner() address 
		âš™ï¸ğŸ‘€ _checkOwner() 
		â— renounceOwnership() 
		â— transferOwnership(address newOwner) 
		âš™ï¸ _transferOwnership(address newOwner) 
	}

	class FeeManager {
		ğŸ”’ uint64 _feeIn
		ğŸ”’ uint64 _feeOut
		â— uint64 feePrecision
		â— uint maxFee
		ğŸ”’ address _feeTo
		â— setFees(uint64 feeIn_, uint64 feeOut_) 
		â— setFeeTo(address feeTo_) 
		âš™ï¸ğŸ§® _calculateFee(uint amount, uint112 fee) uint 
		â—ğŸ‘€ feeIn() uint112 
		â—ğŸ‘€ feeOut() uint112 
		â—ğŸ‘€ feeTo() address 
	}

	class AddressProviderKeeper {
		ğŸ”’ IMaatAddressProvider _addressProvider
		â— bytes4 AddressProviderInterfaceId
		ğŸ”’ğŸ‘€ _validateAddressProviderInterface(address addressProvider_) 
		â—ğŸ‘€ addressProvider() IMaatAddressProvider 
	}

	class Roles {
		â— address commander
		â— address watcher
		â— setCommander(address _commander) 
		â— setWatcher(address _watcher) 
	}

	class RelatedVaultManager {
		ğŸ”’ mapping(uint32 => address) _relatedVaults
		â— addRelatedVaults(uint32[] _dstEid, address[] _vault) 
		â— removeRelatedVault(uint32 _dstEid) 
		â—ğŸ‘€ getRelatedVault(uint32 _dstEid) _vault 
	}

	class WithdrawRequestLogic {
		âš™ï¸ uint _withdrawCancellationDelay
		â— uint256 emergencyWithdrawalDelay
		â— uint32 chainEid
		ğŸ”’ mapping(bytes32 => WithdrawRequestInfo) _withdrawRequests
		â— setWithdrawCancellationDelay(uint timer) 
		â— setEmergencyWithdrawalDelay(uint timer) 
		âš™ï¸ _createWithdrawRequest(bytes32 intentionId, address _owner, address receiver, uint32 dstEid, uint shares, uint estimatedAmountOut) 
		âš™ï¸ _cancelWithdrawRequest(bytes32 intentionId) owner shares 
		âš™ï¸ _cleanRequestInfo(bytes32 intentionId) 
		â—ğŸ‘€ getWithdrawRequest(bytes32 intentionId) WithdrawRequestInfo 
		â—ğŸ‘€ withdrawCancellationDelay() uint 
		âš™ï¸ğŸ‘€ _validateWithdrawRequestExistence(bytes32 intentionId) 
	}

	class TokenKeeper {
		â— ERC20 token
		ğŸ”’ uint _idle
		âš™ï¸ _increaseIdle(uint value) 
		âš™ï¸ _decreaseIdle(uint value) 
		â—ğŸ‘€ idle() uint 
	}

	class StrategyManager {
		ğŸ”’ mapping(bytes32 => Strategy) _supportedStrategies
		ğŸ”’ mapping(address => bytes32) _strategyAddressToId
		â— addStrategy(address strategy) 
		â— removeStrategy(bytes32 strategyId) 
		â— enableStrategy(bytes32 strategyId) 
		â— disableStrategy(bytes32 strategyId) 
		âš™ï¸ _deleteStrategy(bytes32 strategyId, address strategy) 
		âš™ï¸ _toggleStrategy(bytes32 strategyId, bool isActive) 
		â—ğŸ‘€ getStrategyByAddress(address strategy) bytes32 bool 
		â—ğŸ‘€ getStrategyById(bytes32 strategyId) address bool 
		âš™ï¸ğŸ‘€ _validateStrategyExistence(bytes32 strategyId) 
		âš™ï¸ğŸ‘€ _validateStrategyExistence(address strategy) 
	}

	class BridgeLogic {
		â—ğŸ‘€ stargateAdapter() IStargateAdapter 
		â— finishBridge(uint256 amountBridged, uint32 originEid, bytes32 intentionId) 
		âš™ï¸ _finishBridge(uint amountBridged) 
		âš™ï¸ _bridge(uint256 _amount, uint32 dstEid, bytes32 intentionId) 
		âš™ï¸ _bridgeToUser(uint amount, address _receiver, uint32 dstEid) 
	}

	class Executor {
		â— execute(ActionType[] actionType, ActionInput[] inputs) bool 
		âš™ï¸ _execute(ActionType _type, ActionInput input) 
		âš™ï¸ _depositInStrategy(bytes32 _strategyId, uint amount, bytes32 intentionId) shares 
		âš™ï¸ _withdrawFromStrategy(bytes32 _strategyId, uint amount, bytes32 intentionId) shares 
		âš™ï¸ _fulfillWithdrawRequest(bytes32 intentionId) 
	}

	class Vault {
		â— uint minAmount
		â— deposit(uint _assets, address _receiver) shares 
		â— mint(uint shares, address receiver) assets 
		â— withdraw(uint _assets, address _receiver, address _owner) shares 
		â— redeem(uint256 _shares, address _receiver, address _owner) assets 
		âš™ï¸ _deposit(uint assets, uint shares, address receiver) adjustedAssets adjustedShares 
		âš™ï¸ _redeem(uint _shares, address _receiver, address _owner) assets 
		âš™ï¸ _withdraw(uint _assets, address _receiver, address _owner) adjustedShares 
		âš™ï¸ _sendFunds(address _receiver, uint _assets, uint _shares, uint fee) 
		âš™ï¸ _sendFee(uint fee) 
		â— setMinAmount(uint amount) 
		âš™ï¸ğŸ‘€ _getVaultName(address _asset) string 
		âš™ï¸ğŸ‘€ _getVaultSymbol(address _asset) string 
		â—ğŸ‘€ oracle() IMaatOracleGlobalPPS 
		â—ğŸ‘€ asset() address 
		â—ğŸ‘€ totalAssets() uint 
		â—ğŸ‘€ convertToShares(uint assets) uint 
		â—ğŸ‘€ _convertToSharesByHigherPPS(uint assets) uint 
		âš™ï¸ğŸ‘€ _convertToSharesByLowerPPS(uint assets) uint 
		â—ğŸ‘€ convertToAssets(uint shares) uint 
		âš™ï¸ğŸ‘€ _convertToAssetsByHigherPPS(uint shares) uint 
		âš™ï¸ğŸ‘€ _convertToAssetsByLowerPPS(uint shares) uint 
		â—ğŸ‘€ maxDeposit(address empty) uint256 
		â—ğŸ‘€ maxMint(address empty) uint256 
		â—ğŸ‘€ maxRedeem(address receiver) uint 
		â—ğŸ‘€ maxWithdraw(address receiver) uint 
		â—ğŸ‘€ previewDeposit(uint assets) uint 
		â—ğŸ‘€ previewMint(uint shares) uint 
		â—ğŸ‘€ previewWithdraw(uint assets) uint 
		â—ğŸ‘€ previewRedeem(uint shares) uint 
		â—ğŸ‘€ decimals() uint8 
		âš™ï¸ğŸ§® _validateUser(address _owner, address sender) 
		âš™ï¸ğŸ‘€ _validateMinAmount(uint amount) 
	}

	class MaatVaultV1 {
		âš™ï¸ bytes4 vaultInterfaceId
		â— requestWithdraw(uint shares, uint32 dstEid, address _owner, address receiver) intentionId 
		â— requestRebalance(bytes data) intentionId 
		â— cancelWithdrawal(bytes32 intentionId) owner shares 
		âš™ï¸ _fulfillWithdrawRequest(bytes32 intentionId) 
		â— emergencyWithdraw(bytes32 intentionIdOfFailedWithdrawRequest, ActionInput[] withdrawInputs) 
		â— finishSharesBridge(address account, uint256 value) 
		â—ğŸ’° bridgeShares(uint32 _dstEid, uint256 _amount, bytes options) 
	}



	Ownable <|-- FeeManager

	Ownable <|-- Roles

	Ownable <|-- RelatedVaultManager

	RelatedVaultManager <|-- WithdrawRequestLogic

	Ownable <|-- StrategyManager

	AddressProviderKeeper <|-- StrategyManager

	TokenKeeper <|-- StrategyManager

	Ownable <|-- BridgeLogic

	AddressProviderKeeper <|-- BridgeLogic

	TokenKeeper <|-- BridgeLogic

	RelatedVaultManager <|-- BridgeLogic

	Roles <|-- Executor

	RelatedVaultManager <|-- Executor

	StrategyManager <|-- Executor

	WithdrawRequestLogic <|-- Executor

	BridgeLogic <|-- Executor

	Ownable <|-- Vault

	AddressProviderKeeper <|-- Vault

	FeeManager <|-- Vault

	TokenKeeper <|-- Vault

	Vault <|-- MaatVaultV1

	Executor <|-- MaatVaultV1